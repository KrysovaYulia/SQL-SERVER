#Вывести список учеников и суммарный балл в школе в каждой строке, отсортиро вать по школам в оконной функции. 
--4.1.1

SELECT 
Фамилия 
,Предмет
,Школа 
,Баллы 
,sum(Баллы) OVER(PARTITION BY Школа ORDER BY Школа) AS Кол_Шк 
FROM 
Ученики;


#Вывести список учеников и разницу с баллами следующего ученика при сорти ровке по убыванию баллов, значение по умолчанию использовать 0.
--4.1.2
SELECT
Фамилия,
Предмет,
Школа,
Баллы,
Баллы - LEAD (Баллы, 1, 0) OVER(ORDER BY Баллы DESC) AS Разница
FROM Ученики;


#Напишите запрос, который выводит количество учеников по каждой школе по предметам и промежуточные итоги. NULL значения заменить на соответствующий текст. 
--4.2.1

SELECT
    COALESCE(Школа, 'ИТОГО ПО ВСЕМ ШКОЛАМ') AS Школа,
    COALESCE(Предмет, 'ИТОГО ПО ВСЕМ ПРЕДМЕТАМ') AS Предмет,
    COUNT(ID) AS student_count
FROM
    Ученики
GROUP BY
    ROLLUP(Предмет, Школа)
ORDER BY
    Предмет, Школа;

#Напишите запрос, который выводит названия предметов, фамилии учеников и школы в один столбец.
--4.2.2
SELECT
    CONCAT(
        COALESCE(Предмет, 'Без предмета'),
        ' - ',
        COALESCE(Фамилия, 'Без фамилии'),
        ' - ',
        COALESCE(Школа, 'Без школы')
    ) AS Инфорация
FROM
    Ученики;
